# 掼蛋比赛计分系统

一个基于 Flask 的掼蛋比赛计分和统#### 🎯 牌场传说
## 功能特性

### 基础功能
- ✅ 创建比赛（支持4-12人）
- ✅ 录入每轮成绩
- ✅ 队伍总分统计
- ✅ 级牌计算
- ✅ 选手总分排行榜
- ✅ 选手胜率排行榜

### 🎊 年度总结报告（新功能）

#### 📊 基础统计
- 年度比赛总场次（含已完成场次）
- 总轮次统计
- 参与选手数
- 参赛人次
- 月度比赛分布图表
- 热门地点 TOP3
- **🌅 早起鸟儿**：全年最早开局时间的比赛
- **🌙 深夜牌局**：全年最晚开局时间的比赛

#### 🏆 荣誉榜单
- **年度积分王**：总积分最高的选手
- **年度胜率王**：胜率最高的选手（最少10场）
- **铁人奖**：参赛场次最多的选手
- **最佳搭档**：同队胜率最高的两人组合（最少10场）

#### 🎯 牌场传说
- **头名收割机**：获得第一名次数最多
- **稳定达人**：名次方差最小，发挥最稳定（最少10场）
- **大心脏选手**：最后一轮翻盘次数最多
- **陪跑达人**：参赛多但胜率最低（最少10场）
- **人形锦鲤**：和TA搭档，队友胜率提升最多（最少10场）
- **队友克星**：和TA搭档，队友胜率降低最多（最少10场）
- **过山车玩家**：单场比赛名次波动最大（最少10场）

#### 🔥 过招记录
- **最佳拍档**：搭档次数最多的两人组合
- **黄金搭档**：胜率最高的搭档组合（最少10场）
- **冤家对头**：胜率最低的搭档组合（最少10场）
- **最强宿敌**：对战次数最多的两人（最少10场）

#### 🌟 年度之最
- **单场最高分**：个人单场比赛最高积分
- **单轮最大翻盘**：单轮分差变化最大
- **最激烈比赛**：最终分差最小的比赛
- **最悬殊比赛**：最终分差最大的比赛

#### 💰 年度收益榜（新增）
- **最大赢家**：年度累计收益最高的选手
- **最大输家**：年度累计亏损最多的选手
- **收益排行榜**：完整的收益排名（最少10场）
  - 收益计算规则：胜利队伍收益 = 两队积分差（88封顶），失败队伍亏损 = 两队积分差（88封顶）
  - 即：积分差超过 88 时，按 88 计算收益/亏损

## 技术栈

- **后端**：Flask 3.x + Flask-SQLAlchemy
- **数据库**：SQLite
- **前端**：Bootstrap 5 + Jinja2
- **数据分析**：NumPy

## 安装运行

### 环境要求
- Python 3.7+
- pip

### 依赖安装
```bash
pip install flask flask-sqlalchemy numpy
```

### 运行应用
```bash
python flask_app.py
```

访问地址：http://localhost:8899

## 使用说明

### 创建比赛
1. 点击"创建新比赛"按钮
2. 选择参赛人数（4-12人）
3. 填写比赛时间和地点
4. 输入选手姓名（自动分为奇数队和偶数队）
5. 设置积分规则（系统提供默认规则）

### 录入成绩
1. 进入比赛详情页
2. 在"录入本轮成绩"表单中按名次顺序选择选手
3. 系统自动计算积分
4. 比赛结束后点击"结束比赛"

### 查看年度报告
1. 在主页点击"📊 年度总结报告"按钮
2. 默认显示当前年度的统计数据
3. 可以通过URL参数 `?year=2025` 查看指定年份的报告

## 数据模型

### Match（比赛）
- id：比赛ID
- player_count：参赛人数
- time：比赛时间
- location：比赛地点
- status：比赛状态（ongoing/finished）

### Player（选手）
- id：选手ID
- match_id：关联的比赛
- player_number：选手编号
- name：选手姓名
- team：队伍（1=奇数队，2=偶数队）

### ScoreRule（积分规则）
- id：规则ID
- match_id：关联的比赛
- rank：名次
- points：对应积分

### RoundScore（轮次成绩）
- id：成绩ID
- match_id：关联的比赛
- round_number：轮次
- player_id：选手ID
- rank：本轮名次
- points：本轮积分

## 开发计划

- [ ] 添加选手头像
- [ ] 导出年度报告为PDF
- [ ] 添加更多图表可视化
- [ ] 支持多年度数据对比
- [ ] 添加选手个人主页
- [ ] 支持自定义报告模板

## 许可证

MIT License

## 更新日志

### v2.0.0 (2025-12-08)
- ✨ 新增年度总结报告功能
- ✨ 新增基础统计、荣誉榜单、趣味数据、对战记录、年度之最等多维度统计
- 🎨 优化页面UI和响应式布局

### v1.0.0
- 基础比赛管理功能
- 成绩录入和统计
- 排行榜功能
